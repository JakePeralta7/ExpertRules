# DLL INJECTION USING ALLOCATE VIRTUAL MEMORY PROTECTION RULE 

## Description
This rule detects when there is an attempt to exploit the Protocol Handler Vulnerability of Electron framework CVE-2018-1000006.

## Rule TCL
```tcl
Rule {
    Initiator {
        Match PROCESS {
            Include OBJECT_NAME { -v iexplore.exe }
            Include OBJECT_NAME { -v runtimebroker.exe }
            Include OBJECT_NAME { -v chrome.exe }
        }
    }
    Target {
        Match PROCESS {
            Include OBJECT_NAME { -v code.exe }
            Include OBJECT_NAME { -v skype.exe }
            Include OBJECT_NAME { -v slack.exe }
            Include OBJECT_NAME { -v teams.exe }
            Include PROCESS_CMD_LINE { -v "**--gpu-launcher**" }
            Include -access CREATE
        }
    }
}
```

## Trigger
1. Add and enforce the rule to the exploit prevention policy.
2. Install [Visual Studio Code V1.18](https://code.visualstudio.com/updates/v1_18).
3. Create an HTML file with the following code.
```html
<!DOCTYPE html>
<html>
<body>

<h2>Running cmd...</h2>

<script>
    window.location = 'vscode://aaaaaaaaa" --gpu-launcher="cmd" --aaaaa='
</script>

</body>
</html>
```
3. Right click on the HTML file and open with Microsof EDGE.
2. Click on yes to open Visual Studio Code.

## Notes
Reference to the voulnerability [CVE-2018-1000006](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000006).