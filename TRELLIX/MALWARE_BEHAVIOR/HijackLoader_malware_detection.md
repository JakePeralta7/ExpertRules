# HijackLoader Malware detection

## Author
Trellix

## Description
This rule blocks the print spooler from creating executable file in the location below.It prevents the Elevation of Privilege.

## Rule Class 
File

## Rule TCL
```tcl
Rule {
	Process {
			Include DLL_LOADED -name "pla" { -v 0x1 }
		}
	Target {
		Match FILE {
			Include OBJECT_NAME {  -v "**pipe**" }   
			Include -access "CONNECT_NAMED_PIPE READ WRITE"      
			
		}
		Next_Process_Behavior {
			Target {
					Match PROCESS {   
							Include OBJECT_NAME {  -v "**\\WINDOWS\\SysWOW64\\cmd.exe" }   
							Include -access "CREATE"
					}
			}
		}
	}
}
```

## Notes
HijackLoader is a new malware loader, which has grown in popularity over the past few months. Even though HijackLoader does not contain advanced features, it is capable of using a variety of modules for code injection and execution since it uses a modular architecture, a feature that most loaders do not have.

Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.