# Detect Royal Ransomware Attempting To Download Payloads

## Author
Trellix

## Description
This event indicates a malicious behavior exhibited by Royal Ransomware attack

## Rule Class 
Processes

## Rule TCL
```tcl
Rule {
	Process {
			Include OBJECT_NAME { -v "wscript.exe" }
			Include OBJECT_NAME { -v "cscript.exe" }
		}
	Target {
		Match PROCESS {									
									
			Include OBJECT_NAME { -v "cmd.exe" }
            Include PROCESS_CMD_LINE { -v "*/c **/*.bat" }
                                                      
		    Include -access "CREATE EXECUTE"
			}
    Next_Process_Behavior {
    Target {
	
        Match PROCESS {
                Include OBJECT_NAME { -v "curl.exe" }
                Include PROCESS_CMD_LINE { -v "*http* --output **/* --ssl-no-revoke*" }
                Include -access "CREATE EXECUTE"                                                                           
                        }
                }
        }

	}   
			
}
		

```

## Trigger
Open CMD
Run command "Wscript.exe <path\xxx.js>"

## Tested Platforms
OS: Windows 10 21H1 x64, Windows 10 20H1 x86, Windows Server 2019
ENS: 10.7.0 

## Notes
This rule is applicable only on ENS 10.7.0 or above versions
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.
