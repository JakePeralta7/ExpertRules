# CVE-2007-4559 : Directory traversal vulnerability in Python tarfile module.

## Author
Trellix Enterprise

## Description
This rule trigger indicates usage of vulnerable tar extraction method which can lead to directory traversal functionality overwritting arbitrary files.
The rule requires Trellix Endpoint Security On-Access scan feature to be enabled with V2 DAT version: 10476 or later, MED DAT version: 5101 or later, V3 DAT version as 4928.0 or later.

## Rule Class 
Process

## Rule TCL
```tcl
Rule {
	Reaction SCAN ACTOR_PROCESS ScanAction REPORT
    Process {
        Include OBJECT_NAME { -v "python.exe" }
        Include AggregateMatch -xtype "CodecDLLs" {
        Include DLL_LOADED -name "_bz2" { -v 0x1 }
        Include DLL_LOADED -name "_lzma" { -v 0x1 }
        }
    }

    Target {
        Match FILE {
            Include OBJECT_NAME { -v "*" }
            Exclude OBJECT_NAME { -v "*.log" }
            Exclude OBJECT_NAME { -v "*.py*" }
            Exclude OBJECT_NAME { -v "*.dll" }
            Exclude OBJECT_NAME { -v "*.exe" }                   
            Exclude OBJECT_NAME { -v "*.txt" }
            Exclude OBJECT_NAME { -v "*.rtf" }
            Exclude OBJECT_NAME { -v "*.xls*" }
            Exclude OBJECT_NAME { -v "*.db" }
            Exclude OBJECT_NAME { -v "*.json" }
            Exclude OBJECT_NAME { -v "*.xml" }
            Exclude OBJECT_NAME { -v "*.html" }
            Exclude OBJECT_NAME { -v "*.pdf" }
            Exclude OBJECT_NAME { -v "*.mp3" }
            Exclude OBJECT_NAME { -v "*.mmp4" }
            Exclude OBJECT_NAME { -v "*.png" }
            Exclude OBJECT_NAME { -v "*.bmp" }
            Exclude OBJECT_NAME { -v "*.gif" }
            Exclude OBJECT_NAME { -v "*.jpg" }
            Exclude OBJECT_NAME { -v "*.jpeg" }
            Exclude OBJECT_NAME { -v "*.h*" }
            Exclude OBJECT_NAME { -v "*.doc" }
            Exclude OBJECT_NAME { -v "*.csv" }
            Exclude OBJECT_NAME { -v "*.pkl" }
            Include -access "READ"

        }
    }
}

```

## Tested Platforms
NA

## Notes
This rule works only on Trellix Endpoint Security (ENS) versions 10.7.0 or higher. Trellix Endpoint Security On-Access scan feature should be enabled with V2 DAT version: 10476 or later, MED DAT version: 5101 or later, V3 DAT version as 4928.0 or later.
Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives observed.
