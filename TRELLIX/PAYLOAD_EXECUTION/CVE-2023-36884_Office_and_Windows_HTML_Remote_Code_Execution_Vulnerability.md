# CVE-2023-36884 Office and Windows HTML Remote Code Execution Vulnerability

## Author
Trellix

## Description
This rule prevents execution of Lolbins from office releated application.

## Rule TCL
```tcl
Rule {
    Process {
        Include OBJECT_NAME { -v "Excel.exe" }
        Include OBJECT_NAME { -v "MSAccess.exe" }
        Include OBJECT_NAME { -v "MSPub.exe"}
        Include OBJECT_NAME { -v "POWERPNT.exe" }
        Include OBJECT_NAME { -v "Graph.exe" }
        Include OBJECT_NAME { -v "Visio.exe" }
        Include OBJECT_NAME { -v "WinProj.exe" }
        Include OBJECT_NAME { -v "WinWord.exe" }
        Include OBJECT_NAME { -v "Wordpad.exe" }
    }
    Target {
        Match FILE {
            Include OBJECT_NAME { -v "hh.exe" }
            Include OBJECT_NAME { -v "cmd.exe" }
            Include OBJECT_NAME { -v "powershell.exe" }
            Include OBJECT_NAME { -v "powershell_ise.exe" }
            Include OBJECT_NAME { -v "rundll32.exe" }
            Include OBJECT_NAME { -v "regsvr32.exe" }
            Include OBJECT_NAME { -v "wscript.exe" }
            Include OBJECT_NAME { -v "cscript.exe" }
            Include OBJECT_NAME { -v "pwsh.exe" }
            Include OBJECT_NAME { -v "tasklist.exe" }
            Include OBJECT_NAME { -v "taskkill.exe" }
            Include OBJECT_NAME { -v "tskill.exe" }
            Include OBJECT_NAME { -v "sc.exe" }
            Include OBJECT_NAME { -v "reg.exe" }
            Include OBJECT_NAME { -v "netsh.exe" }
            Include OBJECT_NAME { -v "net.exe" }
            Include OBJECT_NAME { -v "csc.exe" }
            Include OBJECT_NAME { -v "**.cpl" }

            Include -access "EXECUTE"
        }
    }
}
```

## Trigger
1. Add and enforce the rule to the exploit prevention policy.
2. From System32 copy cmd.exe to desktop and rename it to(Ex: Excel.exe,MSAccess.exe,MSPub.exe,POWERPNT.exe,Graph.exe,Visio.exe,WinProj.exe,WinWord.exe,Wordpad.exe).
3. Open renamed application individually(Ex:Excel.exe) and execute target files.


## Notes