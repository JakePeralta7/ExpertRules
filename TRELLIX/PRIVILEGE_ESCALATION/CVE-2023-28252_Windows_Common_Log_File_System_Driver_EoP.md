# CVE-2023-28252: Windows Common Log File System Driver Elevation of Privilege Vulnerability

## Author
Trellix

## Description
This Expert rule detects an out-of-bound write vulnerability achieved by changing offset value pointing to Common Log File System (CLFS) structure in memory.

## Rule Class 
Files

## Rule TCL
```tcl
Rule { 
           Process {
                    Exclude VTP_PRIVILEGES -type BITMASK { -v 0x8 }
           }
           Target {
                  Match FILE {
					Include OBJECT_NAME { -v "ntoskrnl.exe" }
                                        Include -access "EXECUTE"
					     
           }
           Next_Process_Behavior {
				Target { 
					Match FILE {
                      
						Include OBJECT_NAME { -v "**\\Users\\Public\\*.blf"}
                                                Include -access "CREATE"
           } 
              
       }
    }
 }
}
```

## Tested Platforms
OS: Win 10 and ENS: 10.7.0

## Notes
CVE-2023-28252 is a privilege escalation vulnerability, an attacker with access to the system and enough ability to run code can successfully exploit to acquire SYSTEM privileges. The vulnerability can be exploited by ransomware such as Nokoyawa.
