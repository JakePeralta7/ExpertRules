# CVE-2023-24950: Microsoft SharePoint Server Spoofing Vulnerability

## Author
Trellix

## Description
This Expert rule detects an attempt to abuse an improper input validation NTLM relay issue within Sharepoint. This vulnerability can be exploited to achieve EOP.

## Rule Class 
Files

## Rule TCL
```tcl
Rule {
		Process {
			Include OBJECT_NAME { 
				-v "sharepoint.exe"
			}
		}
		Target {
			Match FILE {
				Include OBJECT_NAME { 
					-v "\\\\**\\**.xml"
				}
			Include -access "EXECUTE"
			}
		}
	}
```

## Tested Platforms
OS: Win 2012 R2 ENS: 10.7.0, 10.6.0

## Notes
In a network-based attack an attacker who has privileges to create a site on a vulnerable SharePoint server could use this vulnerability to cause the server to leak its NTLM hash. Customers are advised to fine-tune the rule in their environment or disable the signature if there are false positives.
