# CVE-2022-22947 : Spring Cloud Gateway Remote Code Execution

## Author
Trellix

## Description
This rule blocks the event of any process from system32 folder being executed by vulnerable Spring cloud Gateway applications. In spring cloud gateway versions prior to 3.1.1+ and 3.0.7+ , applications are vulnerable to a code injection attack when the Gateway Actuator endpoint is enabled, exposed and unsecured. A remote attacker could make a maliciously crafted request that could allow arbitrary remote execution on the remote host.

## Rule Class 
Process

## Rule TCL
```tcl
Rule {
    Reaction SCAN ACTOR_PROCESS ScanAction REPORT
    Process {
        Include OBJECT_NAME {
            -v "java.exe"
            -v "javaw.exe"
            -v "tomcat*.exe"
        }
        Include AggregateMatch -xtype "dll1" {
            Include DLL_LOADED -name "java" { -v 0x1 }
        }
        Include AggregateMatch -xtype "dll2" {
            Include DLL_LOADED -name "jvm" { -v 0x1 }
        }
    }
    Target {
        Match PROCESS {
            Include OBJECT_NAME { -v "**\\Windows\\System32\\*.exe" }
            Exclude PROCESS_CMD_LINE { -v "* chcp 1252 *" }
        }
    }
}
```

## Tested Platforms
OS: Windows 10 21H1 x64, Windows 10 20H2 x86
ENS: 10.7.0

## Notes
Extra.DAT can be loaded by the users to further scan the files/software that is responsible for the trigger.
Customers are advised to fine-tune the rule in their environment or enable the signature at report only if there are false positives.