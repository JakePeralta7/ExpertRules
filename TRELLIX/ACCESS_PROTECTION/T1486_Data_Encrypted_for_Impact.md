# T1486 - Data Encrypted for Impact

## Author
Trellix

## Description
This Expert rule detects modification or creation of extensions for existing files to achieve encryption.

## Rule Class 
Files

## Rule TCL
```tcl
Rule {
        Process {
			Exclude VTP_PRIVILEGES -type BITMASK { -v 0x8 }
        }
	Target {
		Match FILE {
			Include OBJECT_NAME {
					-v **.xls.*
					-v **.xlsx.*
					-v **.pdf.*
					-v **.doc.*
					-v **.docx.*
					-v **.ppt.*
					-v **.pptx.*
					-v **.dwg.*
					-v **.bak.*
					-v **.bkf.*
					-v **.pst.*
					-v **.dbx.*
					-v **.zip.*
					-v **.rar.*
					-v **.mdb.*
					-v **.asp.*
					-v **.aspx
					-v **.html.*
					-v **.htm.*
					-v **.dbf.*
					-v **.3dm.*
					-v **.3ds.*
					-v **.3fr.*
					-v **.jar.*
					-v **.3g2.*
					-v **.png.*
					-v **.tif.*
					-v **.3gp.*
					-v **.java.*
					-v **.jpe.*
					-v **.jpeg.*
					-v **.jpg.*
					-v **.jsp.*
					-v **.php.*
					-v **.3pr.*
					-v **.ab4.*
					-v **.accdb.*
					-v **.accde.*
					-v **.accdr.*
					-v **.accdt.*
					-v **.ach.*
					-v **.kbx.*
					-v **.acr.*
					-v **.act.*
					-v **.adb.*
					-v **.ads.*
					-v **.agdl.*
					-v **.ait.*
					-v **.apj.*
					-v **.arw.*
					-v **.asf.*
					-v **.asm.*
					-v **.asx.*
					-v **.avi.*
					-v **.awg.*
					-v **.back.*
					-v **.backup.*
					-v **.backupdb.*
					-v **.pbl.*
					-v **.bank.*
					-v **.bay.*
					-v **.bdb.*
					-v **.bgt.*
					-v **.bik.*
					-v **.bkp.*
					-v **.blend.*
					-v **.bpw.*
					-v **.cdf.*
					-v **.cdr.*
					-v **.cdr3.*
					-v **.cdr4.*
					-v **.cdr5
					-v **.cdr6.*
					-v **.cdrw.*
					-v **.cdx.*
					-v **.ce1.*
					-v **.ce2.*
					-v **.cer.*
					-v **.cfp.*
					-v **.cgm.*
					-v **.cib.*
					-v **.class.*
					-v **.cls.*
					-v **.cmt.*
					-v **.cpi.*
					-v **.cpp.*
					-v **.cr2.*
					-v **.craw.*
					-v **.crt.*
					-v **.crw.*
					-v **.cry.*
					-v **.phtml.*
					-v **.php5.*
					-v **.csh.*
					-v **.csl.*
					-v **.tib.*
					-v **.csv.*
					-v **.dac.*
					-v **.db3.*
					-v **.db-journal.*
					-v **.dc2.*
					-v **.dcr.*
					-v **.dcs.*
					-v **.ddd.*
					-v **.ddoc.*
					-v **.ddrw.*
					-v **.dds.*
					-v **.der.*
					-v **.des.*
					-v **.design.*
					-v **.dgc.*
					-v **.djvu.*
					-v **.dng.*
					-v **.dot.*
					-v **.docm.*
					-v **.dotm.*
					-v **.dotx.*
					-v **.drf.*
					-v **.drw.*
					-v **.dtd.*
					-v **.dxb.*
					-v **.dxf.*
					-v **.dxg.*
					-v **.eml.*
					-v **.eps.*
					-v **.erbsql.*
					-v **.erf.*
					-v **.exf.*
					-v **.fdb.*
					-v **.ffd.*
					-v **.fff.*
					-v **.fmb.*
					-v **.fhd.*
					-v **.fla.*
					-v **.flac.*
					-v **.flv.*
					-v **.fpx.*
					-v **.fxg.*
					-v **.gray.*
					-v **.grey.*
					-v **.gry.*
					-v **.hbk.*
					-v **.hpp.*
					-v **.ibank.*
					-v **.ibd.*
					-v **.ibz.*
					-v **.iif.*
					-v **.iiq.*
					-v **.incpas.*
					-v **.indd.*
					-v **.kc2.*
					-v **.kdbx.*
					-v **.kdc.*
					-v **.key.*
					-v **.kpdx.*
					-v **.locky.*
					-v **.lua.*
					-v **.m4v.*
					-v **.max.*
					-v **.mdc
					-v **.mdf.*
					-v **.mef.*
					-v **.mfw.*
					-v **.mmw.*
					-v **.moneywell.*
					-v **.mos.*
					-v **.mov
					-v **.mp3.*
					-v **.mp4.*
					-v **.mpg.*
					-v **.mrw.*
					-v **.msg.*
					-v **.myd.*
					-v **.ndd.*
					-v **.nef.*
					-v **.nk2.*
					-v **.nop.*
					-v **.nrw.*
					-v **.ns2.*
					-v **.ns3.*
					-v **.ns4.*
					-v **.nsd.*
					-v **.nsf.*
					-v **.nsg.*
					-v **.nsh.*
					-v **.nwb.*
					-v **.nx2.*
					-v **.nxl.*
					-v **.nyf.*
					-v **.oab.*
					-v **.obj.*
					-v **.odb.*
					-v **.odc.*
					-v **.odf.*
					-v **.odg.*
					-v **.odm.*
					-v **.odp.*
					-v **.ods.*
					-v **.odt.*
					-v **.oil.*
					-v **.orf.*
					-v **.ost.*
					-v **.otg.*
					-v **.oth.*
					-v **.otp.*
					-v **.ots.*
					-v **.ott.*
					-v **.p12.*
					-v **.p7b.*
					-v **.p7c.*
					-v **.pab.*
					-v **.pages.*
					-v **.pas.*
					-v **.pat.*
					-v **.pcd.*
					-v **.pct.*
					-v **.pdb.*
					-v **.pdd.*
					-v **.pef.*
					-v **.pem.*
					-v **.pfx.*
					-v **.pl.*
					-v **.plc.*
					-v **.pot.*
					-v **.potm.*
					-v **.potx.*
					-v **.ppam.*
					-v **.pps.*
					-v **.ppsm.*
					-v **.ppsx.*
					-v **.pptm.*
					-v **.prf.*
					-v **.psafe3.*
					-v **.psd.*
					-v **.pspimage.*
					-v **.ptx.*
					-v **.py.*
					-v **.qba.*
					-v **.qbb.*
					-v **.qbm.*
					-v **.qbr.*
					-v **.qbw.*
					-v **.qbx.*
					-v **.qby.*
					-v **.r3d.*
					-v **.raf.*
					-v **.rat.*
					-v **.raw.*
					-v **.rdb.*
					-v **.rtf
					-v **.rw2.*
					-v **.rwl.*
					-v **.rwz.*
					-v **.s3db.*
					-v **.sas7bdat.*
					-v **.say.*
					-v **.sd0.*
					-v **.sda.*
					-v **.sdf.*
					-v **.sldm.*
					-v **.sldx.*
					-v **.sql.*
					-v **.sqlite.*
					-v **.sqlite3.*
					-v **.sqlitedb.*
					-v **.sr2.*
					-v **.srf.*
					-v **.srt.*
					-v **.srw.*
					-v **.st4.*
					-v **.st5.*
					-v **.st6.*
					-v **.st7.*
					-v **.st8.*
					-v **.std.*
					-v **.sti.*
					-v **.stw.*
					-v **.stx.*
					-v **.svg.*
					-v **.swf.*
					-v **.sxc.*
					-v **.sxd.*
					-v **.sxg.*
					-v **.sxi.*
					-v **.sxm.*
					-v **.sxw.*
					-v **.tex.*
					-v **.tga.*
					-v **.thm.*
					-v **.tlg.*
					-v **.vob.*
					-v **.war.*
					-v **.wallet.*
					-v **.wav.*
					-v **.wb2.*
					-v **.wmv.*
					-v **.wpd.*
					-v **.wps.*
					-v **.x11.*
					-v **.x3f.*
					-v **.xis.*
					-v **.xla.*
					-v **.xlam.*
					-v **.xlk.*
					-v **.xlm.*
					-v **.xlr.*
					-v **.xlsb.*
					-v **.xlsm.*
					-v **.xlt.*
					-v **.xltm.*
					-v **.xltx.*
					-v **.xlw.*
					-v **.ycbcra.*
					-v **.yuv.*
					-v **.zepto.*
			}
			Include -access "CREATE WRITE"
		}
		
	}
}
```

## Tested Platforms
Win 1019H1x64, ENS 10.7.0

## Notes
NA
